<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Re & Esercito â€” Scegli il Re</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 32 32%22><text y=%2224%22 font-size=%2224%22>ðŸ‘‘</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css?v=2" />
</head>
<body class="bg-dark gradient no-hscroll no-vscroll body-full choose-page">
  <header class="app-bar">
    <div class="logo">
      <span class="crown">ðŸ‘‘</span>
      <span>Re & Esercito</span>
    </div>
  </header>
  <main class="container">
    <h1 class="title neon text-center">Scegli il tuo loRe</h1>
  <div class="grid two pop-in" style="max-width:980px;margin:0 auto;width:100%">
      <div class="card hover-raise" data-team="A">
        <img class="avatar" width="640" height="360" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'><defs><linearGradient id='g' x1='0' x2='1'><stop offset='0' stop-color='%2306b6d4'/><stop offset='1' stop-color='%238b5cf6'/></linearGradient></defs><rect width='640' height='360' fill='url(%23g)'/></svg>" alt="Re A" />
        <h2 class="accent">Streamer A</h2>
        <div class="meta"><span class="badge" data-count="A">0</span> hanno giurato</div>
        <button class="btn btn-accent">Giura FedeltÃ </button>
      </div>
      <div class="card hover-raise" data-team="B">
        <img class="avatar" width="640" height="360" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='360'><defs><linearGradient id='g' x1='0' x2='1'><stop offset='0' stop-color='%2306b6d4'/><stop offset='1' stop-color='%238b5cf6'/></linearGradient></defs><rect width='640' height='360' fill='url(%23g)'/></svg>" alt="Re B" />
        <h2 class="accent">Streamer B</h2>
        <div class="meta"><span class="badge" data-count="B">0</span> hanno giurato</div>
        <button class="btn btn-accent">Giura FedeltÃ </button>
      </div>
    </div>
  </main>
  <footer class="footer full-overlay">Scegli con saggezza. Cambi solo tra i match.</footer>
  <script src="state.js?v=1"></script>
  <script src="auth.js?v=1"></script>
  <script src="hud.js?v=1"></script>
  <script src="choose.js?v=2"></script>
  <script>
    // Mostra un pulsante "Inizia Partita" solo allo Streamer A dopo accettazione
    (async function(){
      function getParams(){ const p = new URLSearchParams(location.search); return { match: p.get('match')||'' }; }
      const params = getParams();
      const u = window.Auth?.currentUser();
      if (!params.match || !u || u.role !== 'A') return;
      try{
  const s = await (await fetch(`/api/matches/get?id=${encodeURIComponent(params.match)}`)).json();
        if (s && s.status === 'accepted' && s.ownerA && s.ownerA.id === u.id){
          const btn = document.createElement('button');
          btn.textContent = 'Inizia Partita';
          btn.className = 'btn btn-primary';
          btn.style.position = 'fixed'; btn.style.right = '16px'; btn.style.bottom = '16px'; btn.style.zIndex = '20';
          btn.onclick = ()=>{ window.location.href = `minigiochi/ariete.html?match=${encodeURIComponent(params.match)}`; };
          document.body.appendChild(btn);
        }
      } catch(e){}
    })();
  </script>
</body>
</html>